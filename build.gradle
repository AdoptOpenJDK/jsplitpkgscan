plugins {
    id 'java-library'
    id 'org.gradle.java.experimental-jigsaw' version '0.1.1'  
}

ext.mainClassName = 'jdk.Main'
javaModule.name = 'jsplitpkg'

sourceCompatibility = 9
targetCompatibility = 9

jar {
    manifest {
        attributes 'Main-Class': mainClassName
        attributes 'Automatic-Module-Name': 'jsplitpkg'
        metaInf {
            from file('.')
            include 'LICENSE'
        }
    }
}

jar.doLast {
	// temporary work around to enable main class
	// using the jar executable
    Exec jarTask = task(jarTask, type: Exec)
    jarTask.commandLine  System.properties['java.home'] + '/bin/jar',
                         '--update',
                         '--main-class',
                         mainClassName,
                         '--file',
                         jar.archivePath
    jarTask.execute()
}